<div class="leads-container">
  <div class="header">
    <div>
      <h1>Gest√£o de Leads</h1>
      <p class="subtitle">Visualiza√ß√£o sint√©tica - Lista completa de leads</p>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filters-card">
    <h3>Filtros</h3>
    <div class="filters-grid">
      <div class="filter-group">
        <label>Busca Geral</label>
        <input
          type="text"
          [(ngModel)]="filtroBusca"
          (ngModelChange)="applyFilters()"
          placeholder="Nome, CPF, Email ou Telefone"
          class="filter-input"
        />
      </div>

      <div class="filter-group">
        <label>Situa√ß√£o</label>
        <select [(ngModel)]="filtroSituacao" (ngModelChange)="applyFilters()" class="filter-select">
          <option value="">Todas</option>
          <option *ngFor="let situacao of situacoes" [value]="situacao">{{ situacao }}</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Produto</label>
        <select [(ngModel)]="filtroProduto" (ngModelChange)="applyFilters()" class="filter-select">
          <option value="">Todos</option>
          <option *ngFor="let produto of produtos" [value]="produto">{{ produto }}</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Respons√°vel</label>
        <select [(ngModel)]="filtroResponsavel" (ngModelChange)="applyFilters()" class="filter-select">
          <option value="">Todos</option>
          <option *ngFor="let responsavel of responsaveis" [value]="responsavel">{{ responsavel }}</option>
        </select>
      </div>

      <div class="filter-group">
        <button class="btn btn-secondary" (click)="clearFilters()">Limpar Filtros</button>
      </div>
    </div>

    <div class="results-info">
      <strong>{{ leadsFiltered.length }}</strong> lead(s) encontrado(s)
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Carregando leads...</p>
  </div>

  <!-- Tabela de Leads -->
  <div *ngIf="!loading" class="table-card">
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th class="th-actions">A√ß√µes</th>
            <th>Nome</th>
            <th>CPF</th>
            <th>Contato</th>
            <th>Produto</th>
            <th>Fase</th>
            <th>Situa√ß√£o</th>
            <th>Tempo/SLA</th>
            <th>Valor Proposta</th>
            <th>Data Recebimento</th>
            <th>Pr√≥xima A√ß√£o</th>
            <th>Respons√°vel</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let lead of leadsFiltered" class="table-row">
            <td data-label="A√ß√µes" class="td-actions">
              <div class="actions">
                <a [routerLink]="['/leads', lead.id]" class="btn-action" title="Ver Detalhes">
                  <span class="eye-icon">üëÅÔ∏è</span>
                </a>
              </div>
            </td>
            <td data-label="Nome">
              <div class="lead-name">{{ lead.nome }}</div>
            </td>
            <td data-label="CPF" class="mobile-hide">{{ lead.cpf }}</td>
            <td data-label="Telefone">
              <div class="contact-info">
                <div>üìû {{ lead.telefone }}</div>
                <div class="email mobile-hide">‚úâÔ∏è {{ lead.email }}</div>
              </div>
            </td>
            <td data-label="Produto" class="mobile-hide">{{ lead.produto }}</td>
            <td data-label="Fase" class="mobile-hide">
              <div class="fase-badge" [style.background]="getFaseCor(lead.faseId)">
                <span class="fase-icon">{{ getFaseIcone(lead.faseId) }}</span>
                <span class="fase-nome">{{ lead.fase }}</span>
              </div>
            </td>
            <td data-label="Situa√ß√£o">
              <div class="situacao-cascata">
                <span class="badge badge-situacao" [ngClass]="getSituacaoBadgeClass(lead.situacao)">
                  {{ lead.situacao }}
                </span>
              </div>
            </td>
            <td data-label="SLA">
              <div class="sla-info" *ngIf="lead.slaDias && lead.slaDias > 0">
                <div class="sla-days" [ngClass]="getSLAStatus(lead)" [title]="getSLATooltip(lead)">
                  <span class="sla-current">{{ lead.diasNaSituacao }}</span>
                  <span class="sla-separator">/</span>
                  <span class="sla-limit">{{ lead.slaDias }}</span>
                  <span class="sla-label">dias</span>
                </div>
                <div class="sla-progress">
                  <div class="sla-bar" [style.width.%]="getSLAPercentage(lead)" [ngClass]="getSLAStatus(lead)"></div>
                </div>
                <div class="sla-status-text" [ngClass]="getSLAStatus(lead)">
                  {{ getSLAStatusText(lead) }}
                </div>
              </div>
              <div class="sla-info" *ngIf="!lead.slaDias || lead.slaDias === 0">
                <span class="sla-inactive">N/A</span>
              </div>
            </td>
            <td data-label="Valor Proposta" class="valor mobile-hide">{{ formatCurrency(lead.valorProposta) }}</td>
            <td data-label="Data Recebimento" class="mobile-hide">{{ formatDate(lead.dataRecebimento) }}</td>
            <td data-label="Pr√≥xima A√ß√£o" class="mobile-hide">
              <div class="proxima-acao">{{ lead.proximaAcao }}</div>
            </td>
            <td data-label="Respons√°vel" class="mobile-hide">{{ lead.responsavel }}</td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="leadsFiltered.length === 0" class="no-results">
        <p>Nenhum lead encontrado com os filtros aplicados.</p>
      </div>
    </div>
  </div>
</div>
